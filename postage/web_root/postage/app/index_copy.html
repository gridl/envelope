<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, minimal-ui, shrink-to-fit=no, user-scalable=no" />
        <meta name="HandheldFriendly" content="true" />

        <title>Postage</title>


    </head>
    <body>

        <script src="../js/greyspots.js" type="text/javascript"></script>
        <link href="../css/greyspots.css" type="text/css" rel="stylesheet" />

        <script src="resources/sql_split.js" type="text/javascript"></script>

        <div id="editAce"></div>
        <script type="text/javascript" charset="utf-8">
        function rowAndColumnToIndex(strText, intRow, intColumn) {
            'use strict';
            var arrLines, intIndex, i, len;
        
            arrLines = strText.split('\n');
            intIndex = 0;
        
            // count previous full lines
            for (i = 0, len = intRow; i < len; i += 1) {
                if (arrLines[i] !== null && arrLines[i] !== undefined) {
                    intIndex += arrLines[i].length + 1;
                }
            }
        
            // add previous characters
            intIndex += intColumn;
        
            return intIndex;
        }
        window.addEventListener('load', function () {
            var Editor = ace.edit('editAce');
            Editor.setTheme('ace/theme/eclipse');
            Editor.getSession().setMode('ace/mode/sql');
            Editor.setShowPrintMargin(false);
            Editor.setDisplayIndentGuides(true);
            Editor.setShowFoldWidgets(false);
            Editor.session.setUseWrapMode('free');
            Editor.setBehavioursEnabled(false);
            Editor.$blockScrolling = Infinity; // <== blocks a warning
    
            Editor.setOptions({
                'enableBasicAutocompletion': true,
                'enableSnippets'           : true,
                'enableLiveAutocompletion' : true
            });
    
            // if we're on a touch device: make the ace grow with it's content
            if (evt.touchDevice) {
                Editor.setOptions({
                    maxLines: Infinity
                });
                document.getElementById('editAce').classList.add('childrenneedsclick');
                document.getElementById('editAce').style.borderBottom = '1px solid #AAAAAA';
    
            // else: full height
            } else {
                document.getElementById('editAce').style.height = '150em';
            }
    
    
            Editor.setValue(ml(function () {/*SELECT *, 'SELECT0 * FROM test.asdf' AS ";"
FROM wiki.rgroups
Limit 10;
SELECT *, 'SELECT1 * FROM test.asdf' AS ";"
FROM wiki.rgroups
Limit 10;
SELECT *, 'SELECT2 * FROM test.asdf' AS ";"
FROM wiki.rgroups
Limit 10;
SELECT *, 'SELECT3 * FROM test.asdf' AS ";"
FROM wiki.rgroups
Limit 10;










































*/}));
            Editor.focus();
            Editor.addEventListener('click', function () {
                var strScript = Editor.getValue();
                var jsnSelection = Editor.getSelectionRange();
                if (jsnSelection.start.column === 0 ||
                    jsnSelection.start.column === 1
                ) {
                    var intCursorPos = rowAndColumnToIndex(strScript, jsnSelection.start.row, jsnSelection.start.column);
                } else {
                    var intCursorPos = rowAndColumnToIndex(strScript, jsnSelection.start.row, jsnSelection.start.column - 1);
                }
                //console.log(intCursorPos);
                findSqlQueryFromCursor(strScript, intCursorPos);
            });
            //Editor.selection.setSelectionRange(new Range(0, 0, 0, 0));
        });
        

        </script>

        <script src="resources/ace/ace.js" data-ace-base="resources/ace/" type="text/javascript" charset="utf-8"></script>
        <script src="resources/ace/ext-language_tools.js" type="text/javascript"></script>
        <script src="resources/ace/ext-searchbox.js" type="text/javascript"></script>

    </body>
</html>
