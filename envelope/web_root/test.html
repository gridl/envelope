<!DOCTYPE html>
<html>
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, minimal-ui" />

		<title>Envelope Test Backend</title>

		<script src="/js/greyspots.js" type="text/javascript"></script>
		<link href="/css/greyspots.css" rel="stylesheet" type="text/css" />

		<script>
		
	        (function () {
	            'use strict';
	            function ajaxCheckJSONResponseForError(request) {
	                if (request.responseJSON) {
	                    if (request.responseJSON.stat === false) {
	                        return true;
	                    }
	                } else {
	                    return true;
	                }

	                return false;
	            }

	            function ajaxNormalizeError(request) {
	                var response = request.response, jsnTemp, jsnRet = {
	                    'error_title': '',
	                    'error_hint': '',
	                    'error_text': '',
	                    'error_file': '',
	                    'error_context': '',
	                    'original_response': response
	                };

	                // get error title and error hint
	                if (request.bolFrontEndTimeout === true) {
	                    jsnRet.error_text = 'Front-end Timeout Reached';
	                    jsnRet.error_title = 'Front-end Timeout Reached';
	                    jsnRet.error_hint = 'This request took too long. Please report this to a system administrator.';

	                } else if (response.status === 403) {
	                    jsnRet.error_title = '403 Link Is Forbidden';
	                    jsnRet.error_hint = 'You have no permission to use this link. If you need this link contact a system administrator and request permission for this link.';

	                } else if (response.status === 404) {
	                    jsnRet.error_title = '404 Link Could Not Be Found';
	                    jsnRet.error_hint = 'This link does not exist. Please report this to a system administrator.';

	                } else if (response.status === 408) {
	                    jsnRet.error_title = '408 Request Took Too Long';
	                    jsnRet.error_hint = 'This link is broken. Please report this to a system administrator.';

	                } else if (response.status === 500) {
	                    jsnRet.error_title = '500 Internal Server Error';
	                    jsnRet.error_hint = 'This call to the server failed. Please report this to a system administrator.';

	                } else if (response.status === 502) {
	                    jsnRet.error_title = '502 Bad Gateway';
	                    jsnRet.error_hint = 'This link is broken. Please report this to a system administrator.';

	                } else if (response.status === 504) {
	                    jsnRet.error_title = '504 Gateway Timeout';
	                    jsnRet.error_hint = 'This link is broken. Please report this to a system administrator.';
	                }

	                // get error text
	                try {
	                    jsnTemp = JSON.parse(response.responseText || response).dat;

	                    jsnRet.error_text = jsnTemp.error;
	                    jsnRet.error_file = jsnTemp.filename;
	                    jsnRet.error_context = jsnTemp.context;

	                    if (!jsnRet.error_text) {
	                        jsnRet.error_text = JSON.parse(response.responseText || response).dat;
	                    }
	                } catch (err) {
	                    if (response) {
	                        jsnRet.error_text = response.responseText || JSON.stringify(response);
	                    } else {
	                        jsnRet.error_text = jsnRet.error_text || response;
	                    }
	                }

	                jsnRet.error_file = jsnRet.error_file || '';

	                return jsnRet;
	            }

	            GS.ajaxJSON = function (strLink, strParams, callback, intTimeout) {
	                var request = new XMLHttpRequest();

	                callback = callback || function () { };

	                request.onreadystatechange = function () {
	                    var normalizedError;

	                    if (request.readyState === 4) {
	                        try {
	                            request.responseJSON = JSON.parse(request.responseText || request.response);
	                        } catch (e) {
	                            //throw e;
	                        }

	                        if (!ajaxCheckJSONResponseForError(request)) {
	                            callback(request.responseJSON);

	                        } else {
	                            normalizedError = ajaxNormalizeError(request);

	                            // if session error: have the user log back in and refresh
	                            if ((normalizedError.error_text.indexOf('Session expired') === 0 ||
	                                normalizedError.error_text.indexOf('No Cookie') !== -1 ||
	                                normalizedError.error_text.indexOf('requires you to login') !== -1) &&
	                                strLink.indexOf('action_info') === -1) {
	                                    GS.normalUserLogin(function () {
	                                            window.location.reload();
	                                    }, '', request.responseJSON.dat.default_subdomain);

	                                    // else: callback with normalized error
	                            } else {
	                                callback(normalizedError, 'error');
	                            }
	                        }
	                    }
	                };

	                request.open('POST', strLink, true);
	                request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded; charset=UTF-8');
	                request.send(strParams);

	                // if intTimeout has been set: start a timer to abort
	                if (typeof intTimeout === 'number') {
	                    if (request && request.readyState !== 4) {
	                        setTimeout(function () {
	                            request.bolFrontEndTimeout = true;
	                            request.abort();
	                        }, intTimeout);
	                    }
	                }

	                return request;
	            };

	            GS.ajaxText = function (strLink, strParams, callback, intTimeout) {
	                var request = new XMLHttpRequest();

	                callback = callback || function () { };

	                request.onreadystatechange = function () {
	                    var normalizedError;

	                    if (request.readyState === 4) {
	                        if (request.status === 200) {
	                            callback(request.responseText);

	                        } else {
	                            normalizedError = ajaxNormalizeError(request);

	                            // if session error: have the user log back in and refresh
	                            if ((normalizedError.error_text.indexOf('Session expired') === 0 ||
	                                normalizedError.error_text.indexOf('No Cookie') !== -1 ||
	                                normalizedError.error_text.indexOf('requires you to login') !== -1) &&
	                                strLink.indexOf('action_info') === -1) {
	                                    GS.normalUserLogin(function () {
	                                            window.location.reload();
	                                    }); //, '', JSON.parse(request.responseText || request.response).dat.default_subdomain

	                                    // else: callback with normalized error
	                            } else {
	                                    callback(normalizedError, 'error');
	                            }
	                        }
	                    }
	                };

	                request.open('POST', strLink, true);
	                request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded; charset=UTF-8');
					if (strLink === '/test.txt?if_modified_since=true') {
		                request.setRequestHeader('If-Modified-Since', 'Mon, 1 Aug 2050 21:12:11 GMT');
					}
	                request.send(strParams);

	                // if intTimeout has been set: start a timer to abort
	                if (typeof intTimeout === 'number') {
	                    if (request && request.readyState !== 4) {
	                        setTimeout(function () {
	                            request.bolFrontEndTimeout = true;
	                            request.abort();
	                        }, intTimeout);
	                    }
	                }

	                return request;
	            };
	        }());
				var Local = {}, Global = {};
				var strTest = 'test.html';
				var test_random = Math.random().toString().substring(2);
				var test_change_stamp = new Date();
				var test_change_stamp2 = new Date();
				test_change_stamp.setMinutes(test_change_stamp.getMinutes());
				test_change_stamp = test_change_stamp.toISOString().replace('T', ' ').replace(/\..*/gi, '');
				
				test_change_stamp2.setDate(test_change_stamp2.getDate()-1);
				test_change_stamp2.setMinutes(test_change_stamp2.getMinutes());
				test_change_stamp2 = test_change_stamp2.toISOString().replace('T', ' ').replace(/\..*/gi, '');

				function makeArray(count, content) {
					var result = new Array(count);
					if(typeof(content) == "function") {
						for(var i=0; i<count; i++) {
							result[i] = (content(i));
						}
					} else {
						for(var i=0; i<count; i++) {
							result[i] = (content);
						}
					}
					return result;
				}

				// override CMD/CTRL - R
				window.addEventListener('keydown', function (event) {
					var intKeyCode = event.which || event.keyCode;

					if ((event.ctrlKey || event.metaKey) && intKeyCode === 82) {
						event.preventDefault();
						event.stopPropagation();
						GS.pushState({}, 'Envelope Test Backend', '/' + strTest);
						window.location.reload();
					}
				});

				Global.tests = [
			['File Read Fail 1', 'ajax', 404, '/test2.txt', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 2', 'ajax', 404, '/test2.txt', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 3', 'ajax', 404, '/test2.txt', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 4', 'ajax', 404, '/test2.txt', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read', 'ajax', 200, '/test.txt', '',
				ml(function () {/*πππøˆ¨¥†ƒ©√˙∫˚∆¨¥†ƒç©˙∆√˙˚∫∆¨¥ˆ†∂®†®∂¥†®´∑œ£™¢∞§¶•ª¶¥†¶•∞§¢´£¢™§¶§¢•∞‡ﬁ‡´ﬁﬂ‹›Œ„´‰ÁˇÎ¨ÁÏÓ˝ÔÏÇÓ˛˝ÏÎÍ¸‰´ˇÁˇ¨ÁÏˆ˝ØÓ¨ÒÁ¨ˆÁØ‡°ˇ°‰ﬂﬁ´›ﬁ‹€ﬁ„‹†´®ß©≈˙ƒ∆˙©∆˚˚136789864512321
*/ })],
			//Custom GS.ajaxText looks for /test.txt?if_modified_since=true
			//It then sends a If-Modified-Since header
			['ACCEPTNC FAIL', 'ajax', 500, '/env/public.acceptnc_testing1', 'testingnitset', ml(function () {/*"FATAL\nDB_exec failed:\nFATAL\nerror_text\tERROR:  function public.acceptnc_testing1(unknown) does not exist\\nLINE 1: SELECT public.acceptnc_testing1('testingnitset');\\n               ^\\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\\n\nerror_detail\t\nerror_hint\tNo function matches the given name and argument types. You might need to add explicit type casts.\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })],
			['ACCEPTNC', 'ajax', 200, '/env/public.acceptnc_testing', 'testingnitset', 'testingnitset'],
			['ACTIONNC FAIL', 'ajax', 500, '/env/public.actionnc_testing1', 'testingnitset', ml(function () {/*"FATAL\nDB_exec failed, res->status == 5:\nFATAL\nerror_text\tERROR:  function public.actionnc_testing1(unknown) does not exist\\nLINE 1: SELECT public.actionnc_testing1('testingnitset');\\n               ^\\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\\n\nerror_detail\t\nerror_hint\tNo function matches the given name and argument types. You might need to add explicit type casts.\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })],
			['ACTIONNC', 'ajax', 200, '/env/public.actionnc_testing', 'testingnitset', '{"stat":true, "dat": "testingnitset"}'],
			['File Read If-Modified-Since', 'ajax', 304, '/test.txt?if_modified_since=true', '', ''],
			['List Connections', 'ajax', 500, '/env/auth', 'action=list',
				ml(function () {/*"The list action is useful in postage, but not envelope."*/})],
			['Login', 'ajax', 200, '/env/auth', 'action=login&connname=doesntexist&username=postgres&password=password',
				ml(function () {/*{"stat": true, "dat": "/env/app/all/index.html"}*/ })],
			['Login Fail 2', 'ajax', 500, '/env/auth', 'action=login&connname=test&username=doesntexist&password=password',
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"doesntexist\"\n"*/ })],
			['Login Fail 3', 'ajax', 500, '/env/auth', 'action=login&connname=test&username=' + encodeURIComponent('test"test') +
						'&password=' + encodeURIComponent('asdfasdfasdfasdfasdf'),
							ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"test\"test\"\n"*/ })],
			['Login Fail 4', 'ajax', 500, '/env/auth', 'action=login&connname=test&username=' + encodeURIComponent('test"tes\'t2') +
						'&password=' + encodeURIComponent('asdfasdfasdfasdfasdf'),
							ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"test\"tes't2\"\n"*/ })],
			['Login Fail 5', 'ajax', 500, '/env/auth', 'action=login&connname=test&username=' + encodeURIComponent('test"test3') +
						'&password=' + encodeURIComponent('asdfasdf\'asdf"asdfasdf'),
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"test\"test3\"\n"*/ })],
			['Login Fail 6', 'ajax', 500, '/env/auth', 'action=login&connname=test&password=' + encodeURIComponent('asdfasdf\'asdf"asdfasdf'),
				ml(function () {/*"FATAL\nno username"*/ })],
			['Login Fail 7', 'ajax', 500, '/env/auth', 'action=login&connname=&username=password=asdfasdfasdfasdf',
				ml(function () {/*"FATAL\n..\\..\\db_framework_pq\\db_framework.c:escape_conninfo_value: escape_conninfo_value: strlen = 0\nConnect failed: fe_sendauth: no password supplied\n"*/ })],
			['Login Fail 8', 'ajax', 500, '/env/auth', 'action=login&connname=&username=&password=',
				ml(function () {/*"FATAL\nno username"*/ })],
			['Login Fail 9', 'ajax', 500, '/env/auth', 'action=login&connname=test&username=&password=',
				ml(function () {/*"FATAL\nno username"*/ })],
			['Login Fail 10', 'ajax', 500, '/env/auth', '',
				ml(function () {/*"Not a valid action."*/ })],
			['Login Fail 11', 'ajax', 500, '/env/auth', 'action=login',
				ml(function () {/*"FATAL\nno username"*/ })],
			['Login Fail 12', 'ajax', 500, '/env/auth', 'action=login&connname=asdfadsf&username=postgres&password=fasdf',
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"postgres\"\n"*/})],
			['Login Fail 13 *', 'ajax spam', 500, '/env/auth', 'action=login&connname=test&username=postgres&password=fasdf',
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"postgres\"\n"*/})],
			['Login Fail 14', 'ajax', 500, '/env/auth', 'action=login&connname=ip%20example&username=postgres&password=fasdf',
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"postgres\"\n"*/})],
			['Login Fail 15', 'ajax', 500, '/env/auth', 'action=login&connname=test&username=postgres&password=' + encodeURIComponent('test!@#$%^&*()|<>?,./:+-*/=ƒ©˙∆test'),
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"postgres\"\n"*/ })],
			['Login Fail 16', 'ajax', 500, '/env/auth', 'action=login&connname=test&username=' + encodeURIComponent('test!@#$%^&*()|<>?,./:+-/*=ƒ©˙∆test') + '&password=testtest',
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"test!@#$%^&*()|<>?,./:+-/*=ƒ©˙∆test\"\n"*/ })],
			['Login Fail 17', 'ajax', 500, '/env/auth', 'action=' + encodeURIComponent('loginπ'),
				ml(function () {/*"Not a valid action."*/ })],
			['Login Fail 18', 'ajax', 500, '/env/auth', 'action=loginbasdf',
				ml(function () {/*"Not a valid action."*/ })],
			['Login Fail 19', 'ajax', 500, '/env/auth', 'action=login&connection=' + encodeURIComponent('π') + '&username=' + encodeURIComponent('π') + '&password=' + encodeURIComponent('π'),
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"π\"\n"*/ })],
			['Login Fail 20', 'ajax', 500, '/env/auth', 'action=login&connection=' + encodeURIComponent('π\'π') + '&username=' + encodeURIComponent('π') + '&password=' + encodeURIComponent('π'),
				ml(function () {/*"FATAL\nConnect failed: FATAL:  password authentication failed for user \"π\"\n"*/ })],
			['Login Fail 21', 'ajax', 404, '/env/authasdf', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['Login Fail 22', 'ajax', 500, '/env/auth', 'test=test&a@&#=te=st',
				ml(function () {/*"Not a valid action."*/ })],
			['Logout before login *', 'ajax spam', 200, '/env/auth', 'action=logout', ''],
			['Login 1', 'ajax', 200, '/env/auth', 'action=login&connname=test&username=postgres&password=password',
				ml(function () {/*{"stat": true, "dat": "/env/app/all/index.html"}*/ })],
			[
				'Login 2',
				'ajax',
				200,
				'/env/auth',
				new Blob(['action=login&connname=test&username=postgres&password=password'], {type: 'text/plain'}),
				ml(function () {/*{"stat": true, "dat": "/env/app/all/index.html"}*/ })
			],
			[
				'Login 3',
				'ajax',
				200,
				'/env/auth',
				new Blob(['action=login&connname=test&username=postgres&password=password'], {type: 'application/octet-binary'}),
				ml(function () {/*{"stat": true, "dat": "/env/app/all/index.html"}*/ })
			],
			[
				'Login 4',
				'ajax', 200,
				'/env/auth',
				new Blob(['action=login&connname=test&username=postgres&password=password'], {type: 'application/x-binary'}),
				ml(function () {/*{"stat": true, "dat": "/env/app/all/index.html"}*/ })
			],
			['Login 5 *', 'ajax spam', 200, '/env/auth', 'action=login&connname=test&username=postgres&password=password',
				ml(function () {/*{"stat": true, "dat": "/env/app/all/index.html"}*/ })],
			
			['File Read Fail 5', 'ajax', 500, '/env/0//index.html', '',
				function (arg) {
					console.warn('test1');
					return arg === ml(function () {/*"FATAL\n../util/util_canonical.c:canonical: 0//index.html is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\util\\util_canonical.c:canonical: 0\\\\index.html is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
				}
			],
			['File Read Fail 6', 'ajax', 404, '/env/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/asdf/index.html', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 7', 'ajax', 404, '/env/00/index.html', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 8', 'ajax', 404, '/env/postage/0/index.html', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 9', 'ajax', 500, '/env/0/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/index.html', '',
				function (arg) {
					console.warn('test2');
					return ml(function () {/*"FATAL\n../util/util_canonical.c:canonical: 0/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/ASDF/AS\nBad file path"*/ })
						|| ml(function () {/*"FATAL\n..\\..\\util\\util_canonical.c:canonical: 0\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\ASDF\\AS\nBad file path"*/ })
				}
			],
			['File Read 2', 'ajax', 200, '/test.txt', '',
				ml(function () {/*πππøˆ¨¥†ƒ©√˙∫˚∆¨¥†ƒç©˙∆√˙˚∫∆¨¥ˆ†∂®†®∂¥†®´∑œ£™¢∞§¶•ª¶¥†¶•∞§¢´£¢™§¶§¢•∞‡ﬁ‡´ﬁﬂ‹›Œ„´‰ÁˇÎ¨ÁÏÓ˝ÔÏÇÓ˛˝ÏÎÍ¸‰´ˇÁˇ¨ÁÏˆ˝ØÓ¨ÒÁ¨ˆÁØ‡°ˇ°‰ﬂﬁ´›ﬁ‹€ﬁ„‹†´®ß©≈˙ƒ∆˙©∆˚˚136789864512321
*/ })],
			['File Read 3', 'ajax', 200, '/test.txt', '',
				ml(function () {/*πππøˆ¨¥†ƒ©√˙∫˚∆¨¥†ƒç©˙∆√˙˚∫∆¨¥ˆ†∂®†®∂¥†®´∑œ£™¢∞§¶•ª¶¥†¶•∞§¢´£¢™§¶§¢•∞‡ﬁ‡´ﬁﬂ‹›Œ„´‰ÁˇÎ¨ÁÏÓ˝ÔÏÇÓ˛˝ÏÎÍ¸‰´ˇÁˇ¨ÁÏˆ˝ØÓ¨ÒÁ¨ˆÁØ‡°ˇ°‰ﬂﬁ´›ﬁ‹€ﬁ„‹†´®ß©≈˙ƒ∆˙©∆˚˚136789864512321
*/ })],
			['File Read Fail 10', 'ajax', 404, '/env/0/index.htm', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 11', 'ajax', 500, '/env/0/index.π', '',
				function (arg) {
					console.warn('test1');
					return arg === ml(function () {/*"FATAL\n../util/util_canonical.c:canonical: 0/index.π is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\util\\util_canonical.c:canonical: 0\\index.π is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
				}
			],
			['File Read Fail 12', 'ajax', 404, '/env/0/index.php', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 13', 'ajax', 404, '/env/index.php', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['File Read Fail 14', 'ajax', 500, '/env/π', '',
				function (arg) {
					console.warn('test1');
					return arg === ml(function () {/*"FATAL\n../util/util_canonical.c:canonical: π is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\util\\util_canonical.c:canonical: π is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
				}
			],
			['File Read Fail 15', 'ajax', 500, ml(function () {/*/env/0/index.html?view=home&test=!@#$%^&*()<>?:"{}|,./;'[]\=/*-+.~`œ∑´®†¥¨ˆøπåßƒ©˙∆˚¬Ω≈√∫˜µŒ„´‰ˇÁ¨ˆØ∏ÅÍÎÏ˝ÓÔÒ¸˛Ç◊ı˜Â*/}), '',
				function (arg) {
					console.warn('test1');
					return arg === ml(function () {/*"FATAL\n../util/util_canonical.c:canonical: * is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\util\\util_canonical.c:canonical: * is a bad path. Path contains invalid characters.\n\nBad file path"*/ })
				}
			],
			['File Read 4', 'ajax', 200, '/test.txt?test=test/env/index.html?test=test', '',
				ml(function () {/*πππøˆ¨¥†ƒ©√˙∫˚∆¨¥†ƒç©˙∆√˙˚∫∆¨¥ˆ†∂®†®∂¥†®´∑œ£™¢∞§¶•ª¶¥†¶•∞§¢´£¢™§¶§¢•∞‡ﬁ‡´ﬁﬂ‹›Œ„´‰ÁˇÎ¨ÁÏÓ˝ÔÏÇÓ˛˝ÏÎÍ¸‰´ˇÁˇ¨ÁÏˆ˝ØÓ¨ÒÁ¨ˆÁØ‡°ˇ°‰ﬂﬁ´›ﬁ‹€ﬁ„‹†´®ß©≈˙ƒ∆˙©∆˚˚136789864512321
*/ })],
			['File Read Fail 16', 'ajax', 404, '/postag', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			
			['Invalid Action', 'ajax', 500, '/env/auth', 'action=change_password&password_old=password&password_new=test1',
				ml(function () {/*"Not a valid action."*/ })],
			['Change Password', 'ajax', 200, '/env/auth', 'action=change_pw&password_old=password&password_new=test1',
				ml(function () {/*{"stat": true, "dat": "OK"}*/ })],
			['Change Password Fail', 'ajax', 500, '/env/auth', 'action=change_pw&password_old=test&password_new=test',
				ml(function () {/*"FATAL\nOld password does not match."*/ })],
			['Change Password', 'ajax', 200, '/env/auth', 'action=change_pw&password_old=test1&password_new=password',
				ml(function () {/*{"stat": true, "dat": "OK"}*/ })],
			['Change Database', 'ajax', 500, '/env/auth', 'action=change_database&database=template1',
				ml(function () {/*"The change_database action is useful in postage, but not envelope."*/})],
				
			//['WAIT', 'wait'],
			['Login', 'ajax', 200, '/env/auth', 'action=login&connname=test&username=postgres&password=password',
				ml(function () {/*{"stat": true, "dat": "/env/app/all/index.html"}*/ })],
				
			['WEBSOCKET OPEN W/INFO ACTION', 'websocket start', '', '', ''],
		];
		
		Global.app_tests = [
			['App Upload Fail 1', 'ajax', 500, '/env/upload', '',
				function (arg) {
					console.warn('test1');
					return arg === ml(function () {/*"FATAL\n../util/util_request.c:get_sun_upload: Cannot find boundary for request\nget_sun_upload failed"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\util\\util_request.c:get_sun_upload: Cannot find boundary for request\nget_sun_upload failed"*/ })
				}
			],
			['App Upload', 'upload', 200, '/env/upload', '/app//all/test5.txt',
				ml(function () {/*Upload Succeeded
*/})],
			['App Upload Fail 2', 'upload', 500, '/env/upload', '/app/all/test5.txt',
				ml(function () {/*FATAL
File already exists.*/})],
			['App Download Fail 1', 'ajax', 404, '/env/app/all/test4.txt', '',
				ml(function () {/*"The file you are requesting is not here."*/ })],
			['App Download', 'ajax', 200, '/env/app/all/test5.txt', '',
				'SELECT \'This is \0some\n\n tesr\r\n\r\nt \r\rsql\';'],
			['APP FILE DELETE 1', 'websocket', '', 'FILE\tDELETE\t/app/all/test5.txt',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE LIST FAIL 1', 'websocket', '', 'FILE LIST ' +
				GS.encodeForTabDelimited('/open/') + '\n',
				['Invalid Request', 'TRANSACTION COMPLETED']],
			['APP FILE LIST FAIL 2', 'websocket', '', 'FILE\tLIST\t' +
				GS.encodeForTabDelimited('/ipen/') + '',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE LIST FAIL 3', 'websocket', '', 'FILE\tLISTA\t' +
				GS.encodeForTabDelimited('/open/') + '',
				["Unknown FILE request type LISTA","TRANSACTION COMPLETED"]],
			['APP FILE LIST FAIL 4', 'websocket', '', 'FILE\tLIST\t' +
				GS.encodeForTabDelimited('///////') + '',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE LIST FAIL 5', 'websocket', '', 'FILE\tLIST\t' +
				GS.encodeForTabDelimited('../../') + '',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE LIST FAIL 6', 'websocket', '', 'FILE\tLIST\t' +
				GS.encodeForTabDelimited('/asdf/asdf/asdf/asd/fasdf/asdf/') + '',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE LIST FAIL 7', 'websocket', '', 'FILE\tLIST\t' +
				GS.encodeForTabDelimited('/πππ/') + '',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE LIST FAIL 8', 'websocket', '', 'FILE\tLIST',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE LIST FAIL 9', 'websocket', '', 'FILE LIST',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE LIST FAIL 10', 'websocket', '', 'FILE|LIST',
				["Invalid Request Type \"FILE|LIST\"\n"]],
			['APP FILE LIST FAIL 11', 'websocket', '', 'FILE\t',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE LIST FAIL 12', 'websocket', '', 'FILE',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE LIST FAIL 13', 'websocket', '', 'FILE\tLIST\t' +
				encodeURIComponent('..') + '',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE LIST', 'websocket', '', 'FILE\tLIST\t/',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE LIST', 'websocket', '', 'FILE\tLIST\t/app',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE LIST', 'websocket', '', 'FILE\tLIST\t/app/',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE 1', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txt\t0\nTESTING\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE READ TO PREPARE', 'websocket', '', 'FILE\tREAD\t/app/all/test.txt\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE 1', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txt\t{{CHANGESTAMP}}\nThis is a test1\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE 2', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txt\t{{CHANGESTAMP}}\nThis is a test2\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE FAIL 1', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txt\t' + test_change_stamp2 + '\nThis is a test2\n',
				['Someone updated this file before you.']],
			['APP FILE READ TO PREPARE', 'websocket', '', 'FILE\tREAD\t/app/all/test.txt\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE 3', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txt\t{{CHANGESTAMP}}\nπππøˆ¨¥†ƒ©√˙∫˚∆¨¥†ƒç©˙∆√˙˚∫∆¨¥ˆ†∂®†®∂¥†®´∑œ£™¢∞§¶•ª¶¥†¶•∞§¢´£¢™§¶§¢•∞‡ﬁ‡´ﬁﬂ‹›Œ„´‰ÁˇÎ¨ÁÏÓ˝ÔÏÇÓ˛˝ÏÎÍ¸‰´ˇÁˇ¨ÁÏˆ˝ØÓ¨ÒÁ¨ˆÁØ‡°ˇ°‰ﬂﬁ´›ﬁ‹€ﬁ„‹†´®ß©≈˙ƒ∆˙©∆˚˚136789864512321\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE READ TO PREPARE', 'websocket', '', 'FILE\tREAD\t/app/all/test.txt\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE FAIL 2', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txtπ\t{{CHANGESTAMP}}\nThis is a test1\n',
				[
					[
						"../util/util_canonical.c:canonical: all/test.txtπ is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|all/test.txtπ<",
						"..\\..\\util\\util_canonical.c:canonical: all\\test.txtπ is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|all/test.txtπ<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE WRITE FAIL 3', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txt\t',
				["Someone updated this file before you."]],
			['APP FILE WRITE FAIL 4', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txt',
				["Invalid Request"]],
			['APP FILE WRITE FAIL 5', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txtπ\tCHANGESTAMP\nThis is a test1\n',
				[
					[
						"../util/util_canonical.c:canonical: all/test.txtπ is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|all/test.txtπ<",
						"..\\..\\util\\util_canonical.c:canonical: all\\test.txtπ is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|all/test.txtπ<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE WRITE FAIL 6', 'websocket', '', 'FILE\tWRITE\t/app/all/test.txtπ\t\'2016-8-8 11:15:46\'\nThis is a test1\n',
				[
					[
						"../util/util_canonical.c:canonical: all/test.txtπ is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|all/test.txtπ<",
						"..\\..\\util\\util_canonical.c:canonical: all\\test.txtπ is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|all/test.txtπ<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE WRITE 4', 'websocket', '', 'FILE\tWRITE\t/app/all/test1.txt\t10000000000000\nThis is a test\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE FAIL 8', 'websocket', '', 'FILE\tWRITE\t/app/all/test1.txt 10000000000000\nThis is a test\n',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE WRITE 5', 'websocket', '', 'FILE\tWRITE\t/app/all/test/test.txt\t' + test_change_stamp + '\nThis is a test\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE 6', 'websocket', '', 'FILE\tWRITE\t/app/all/test/test2/test.txt\t' + test_change_stamp + '\nThis is a test\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE 7', 'websocket', '', 'FILE\tWRITE\t/app/all/test3/test.txt\t' + test_change_stamp + '\nThis is a test\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE WRITE 8', 'websocket', '', 'FILE\tWRITE\t/app/all/test/test2/test2.txt\t' + test_change_stamp + '\nThis is a test\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE READ PREPARE (WRITE 1)', 'websocket', '', 'FILE\tWRITE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.txt') + '\t0\n' +
				'This is a test of the search. (test line #1)' + '\n' +
				'This is a test of the bran muffin. (test line #2)' + '\n' +
				'This is a test of the tv. (test line #3)' + '\n' +
				'This is a test of the envelope. (test line #4)',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE READ PREPARE (WRITE 2)', 'websocket', '', 'FILE\tWRITE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test2.txt') + '\t0\n' +
				'This is a test of the search. (test line #1)' + '\n' +
				'This is a test of the bran muffin. (test line #2)' + '\n' +
				'This is a test of the tv. (test line #3)' + '\n' +
				'This is a test of the envelope. (test line #4)',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE READ FAIL 1', 'websocket', '', 'FILE\tREAD\t/appp/all/test.txt',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE READ FAIL 2', 'websocket', '', 'FILE\tREAD\t/ap/all/test.txt',

				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE READ FAIL 3', 'websocket', '', 'FILE\tREAD\t' + GS.encodeForTabDelimited('/role/trusted_g/test.txt > /role/trusted_g/test2.txt'),
				[
					[
						"../util/util_canonical.c:canonical: trusted_g/test.txt > /role/trusted_g/test2.txt is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/role|trusted_g/test.txt > /role/trusted_g/test2.txt<",
						"..\\..\\util\\util_canonical.c:canonical: trusted_g\\test.txt > \\role\\trusted_g\\test2.txt is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\role|trusted_g/test.txt > /role/trusted_g/test2.txt<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE READ FAIL 4', 'websocket', '', 'FILE\tREAD\t' + GS.encodeForTabDelimited(''),
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE READ FAIL 5', 'websocket', '', 'FILE\tREAD\t' + GS.encodeForTabDelimited('../'),
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE READ FAIL 6', 'websocket', '', 'FILE\tREAD\t' + GS.encodeForTabDelimited('π'),
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE READ 1', 'websocket', '', 'FILE\tREAD\t/app/all/test.txt',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE READ 2', 'websocket', '', 'FILE\tREAD\t' + GS.encodeForTabDelimited('/role/trusted_g/test.txt'),
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE READ END 1', 'websocket', '', 'FILE\tDELETE\t/app/trusted_g/test.txt',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE READ END 2', 'websocket', '', 'FILE\tDELETE\t/app/trusted_g/test2.txt',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE MOVE FAIL 1', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('/test.txt') + '\t' +
				GS.encodeForTabDelimited('/test2.txt') + '\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE MOVE FAIL 2', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('') + '\t' +
				GS.encodeForTabDelimited('/app/all/test2.txt') + '\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE MOVE FAIL 3', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('/app/all/test.txt') + '\t' +
				GS.encodeForTabDelimited('') + '\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE MOVE FAIL 4', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('/app/all/test.txt') + '\n',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE MOVE FAIL 5', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('/app/all/test.txt'),
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE MOVE FAIL 6', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('../') + '\t' +
				GS.encodeForTabDelimited('/') + '\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE MOVE FAIL 7', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('/') + '\t' +
				GS.encodeForTabDelimited('../') + '\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE MOVE FAIL 8', 'websocket', '', 'FILE\tMOVE\t' +
				GS.encodeForTabDelimited('/') + '\t' +
				GS.encodeForTabDelimited('../'),
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE MOVE', 'websocket', '', 'FILE\tMOVE\t/app/all/test.txt\t/app/all/test2.txt',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE COPY FAIL', 'websocket', '', 'FILE\tCOPY\t/test2.txt\t/app/all/test1.txt',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE COPY', 'websocket', '', 'FILE\tCOPY\t/app/all/test2.txt\t/app/all/test.txt',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE CREATE_FOLDER FAIL 1', 'websocket', '', 'FILE\tCREATE_FOLDER\t/test/\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FOLDER FAIL 2', 'websocket', '', 'FILE\tCREATE_FOLDER\t' + GS.encodeForTabDelimited('/app/trusted_g/test-test--test-test') + '\n',
				[
					[
						"../util/util_canonical.c:canonical: trusted_g/test-test--test-test is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|trusted_g/test-test--test-test<",
						"..\\..\\util\\util_canonical.c:canonical: trusted_g\\test-test--test-test is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|trusted_g/test-test--test-test<"
					]
				]
			],
			['APP FILE CREATE_FOLDER FAIL 3', 'websocket', '', 'FILE\tCREATE_FOLDER',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE CREATE_FOLDER FAIL 4', 'websocket', '', 'FILE\tCREATE_PI',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE CREATE_FOLDER FAIL 5', 'websocket', '', 'FILE\tCREATE_FOLDER\t' + GS.encodeForTabDelimited('/app/trusted_g///////') + '\n',
				[
					[
						"../util/util_canonical.c:canonical: trusted_g/////// is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|trusted_g///////<",
						"..\\..\\util\\util_canonical.c:canonical: trusted_g\\\\\\\\\\\\\\ is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|trusted_g///////<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FOLDER FAIL 6', 'websocket', '', 'FILE\tCREATE_FOLDER\t' + GS.encodeForTabDelimited('/role/trusted_g/ > /opt/test') + '\n',
				[
					[
						"../util/util_canonical.c:canonical: trusted_g/ > /opt/test is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/role|trusted_g/ > /opt/test<",
						"..\\..\\util\\util_canonical.c:canonical: trusted_g\\ > \\opt\\test is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\role|trusted_g/ > /opt/test<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FOLDER FAIL 7', 'websocket', '', 'FILE\tCREATE_FOLDER\t' + GS.encodeForTabDelimited('/role/trusted_g/ > /opt/test'),
				[
					[
						"../util/util_canonical.c:canonical: trusted_g/ > /opt/test is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/role|trusted_g/ > /opt/test<",
						"..\\..\\util\\util_canonical.c:canonical: trusted_g\\ > \\opt\\test is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\role|trusted_g/ > /opt/test<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FOLDER FAIL 8', 'websocket', '', 'FILE\tCREATE_FOLDER\t' + GS.encodeForTabDelimited('/role/trusted_g/π'),
				[
					[
						"../util/util_anonical.c:canonical: trusted_g/π is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/role|trusted_g/π<",
						"..\\..\\util\\util_canonical.c:canonical: trusted_g\\π is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\role|trusted_g/π<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FOLDER', 'websocket', '', 'FILE\tCREATE_FOLDER\t/app/all/test3/test4/',
				['ANYTHING', 'TRANSACTION COMPLETED']],

			['APP FILE CREATE_FILE FAIL 1', 'websocket', '', 'FILE\tCREATE_FILE\t/test.txt' +
				GS.encodeForTabDelimited('/') + '\t' +
				GS.encodeForTabDelimited('../') + '\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FILE FAIL 2', 'websocket', '', 'FILE\tCREATE_FILE',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE CREATE_FILE FAIL 3', 'websocket', '', 'FILE\tCREATE_FILE\t',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FILE FAIL 4', 'websocket', '', 'FILE\tCREATE_FILE\n',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE CREATE_FILE FAIL 5', 'websocket', '', 'FILE\tCREATE_FILEA\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.txt'),
				["Unknown FILE request type CREATE_FILEA","TRANSACTION COMPLETED"]],
			['APP FILE CREATE_FILE FAIL 6', 'websocket', '', 'FILE\tCREATE_FILEA\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.txt') + '\n',
				["Unknown FILE request type CREATE_FILEA","TRANSACTION COMPLETED"]],
			['APP FILE CREATE_FILE', 'websocket', '', 'FILE\tCREATE_FILE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.txt') + '\n',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE CREATE_FILE FAIL 7', 'websocket', '', 'FILE\tCREATE_FILE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.txt') + '\n',
				[
					[
						"File already exists.",
						"CreateFile failed: 0x50 (The file exists.\r\n)"
					]
				]
			],
			['APP FILE CREATE_FILE FAIL 8', 'websocket', '', 'FILE\tCREATE_FILE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.txt'),
				[
					[
						"File already exists.",
						"CreateFile failed: 0x50 (The file exists.\r\n)"
					]
				]
			],
			['APP FILE CREATE_FILE FAIL 9', 'websocket', '', 'FILE\tCREATE_FILE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.π'),
				[
					[
						"../util/util_canonical.c:canonical: trusted_g/test.π is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|trusted_g/test.π<",
						"..\\..\\util\\util_canonical.c:canonical: trusted_g\\test.π is a bad path. Path contains invalid characters.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|trusted_g/test.π<"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE CREATE_FILE', 'websocket', '', 'FILE\tCREATE_FILE\t' +
				GS.encodeForTabDelimited('/app/all/test3.txt'),
				['ANYTHING', 'TRANSACTION COMPLETED']],

			['APP FILE DELETE FAIL 1', 'websocket', '', 'FILE\tDELETE\t/test.txt',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE DELETE FAIL 2', 'websocket', '', 'FILE\tDELETE\t' + GS.encodeForTabDelimited('../'),
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE DELETE FAIL 3', 'websocket', '', 'FILE\tDELETE\t' + GS.encodeForTabDelimited('π'),
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE DELETE FAIL 4', 'websocket', '', 'FILE\tDELETE',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE DELETE FAIL 5', 'websocket', '', 'FILE\tDELETE   ',
				["Invalid Request","TRANSACTION COMPLETED"]],
			['APP FILE DELETE 2', 'websocket', '', 'FILE\tDELETE\t/app/all/test',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE RECURSIVE COPY FAIL', 'websocket', '', 'FILE\tCOPY\t/app/all/test3/',
				['Invalid Request', 'TRANSACTION COMPLETED']],
			['APP FILE RECURSIVE COPY', 'websocket', '', 'FILE\tCOPY\t/app/all/test3/\t/app/all/test5/',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE DELETE 3', 'websocket', '', 'FILE\tDELETE\t/app/all/test3/',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE DELETE 4', 'websocket', '', 'FILE\tDELETE\t/app/all/test5/',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE DELETE 5', 'websocket', '', 'FILE\tDELETE\t/app/all/test2.txt',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE DELETE 6', 'websocket', '', 'FILE\tDELETE\t/app/all/test3.txt',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE DELETE 7', 'websocket', '', 'FILE\tDELETE\t/app/all/test1.txt',
				['OK', 'TRANSACTION COMPLETED']],
			['APP FILE SEARCH PREPARE (WRITE 1)', 'websocket', '', 'FILE\tWRITE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test.txt') + '\t0\n' +
				'This is a test of the search. (test line #1)' + '\n' +
				'This is a test of the bran muffin. (test line #2)' + '\n' +
				'This is a test of the tv. (test line #3)' + '\n' +
				'This is a test of the envelope. (test line #4)',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE SEARCH PREPARE (WRITE 2)', 'websocket', '', 'FILE\tWRITE\t' +
				GS.encodeForTabDelimited('/app/trusted_g/test/test.txt') + '\t0\n' +
				'This is a test of the search. (test line #1)' + '\n' +
				'This is a test of the bran muffin. (test line #2)' + '\n' +
				'This is a test of the tv. (test line #3)' + '\n' +
				'This is a test of the envelope. (test line #4)',
				['ANYTHING', 'TRANSACTION COMPLETED']],
			['APP FILE SEARCH FAIL 1', 'websocket', '', 'FILE\tSEARCH\t/ap/\tgs-page > gs-header,\nRECURSIVE\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH FAIL 2', 'websocket', '', 'FILE\tSEARCH\t/app/nonexisitant/\tgs-page > gs-header,\nRECURSIVE\n',
				[
					[
						"../util/util_canonical.c:canonical: read_dir: /home/super/Repos/postage/envelope/app/|nonexisitant/ is a bad path. Path does not exist.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|nonexisitant/<",
						"..\\..\\util\\util_canonical.c:canonical: read_dir: \\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app\\|nonexisitant\\ is a bad path. Path does not exist.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|nonexisitant/<"
					]
				]
			],
			['APP FILE SEARCH FAIL 3', 'websocket', '', 'FILE\tSEARCH\t/app/\tThis is a test of the [search|bran|envelope,\nREGEX\n',
				["regcomp failed: 7 (Missing ']')"]],
			['APP FILE SEARCH FAIL 4', 'websocket', '', 'FILE\tSEARCH\t' +
				GS.encodeForTabDelimited('/app/trust_g/') + '\t' +
				GS.encodeForTabDelimited('This....a test of the search') + '\n' +
				'INSENSITIVE\tREGEX' + '\n',
				[
					[
						"../util/util_canonical.c:canonical: read_dir: /home/super/Repos/postage/envelope/app/|trust_g/ is a bad path. Path does not exist.\n\nFailed to get canonical path: >/home/super/Repos/postage/envelope/app|trust_g/<",
						"..\\..\\util\\util_canonical.c:canonical: read_dir: \\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app\\|trust_g\\ is a bad path. Path does not exist.\n\nFailed to get canonical path: >\\Users\\Nunzio Tocci\\Repos\\postage\\envelope\\app|trust_g/<"
					]
				]
			],
			['APP FILE SEARCH FAIL 5', 'websocket', '', 'FILE\tSEARCH\t' +
				GS.encodeForTabDelimited('../../') + '\t' +
				GS.encodeForTabDelimited('This is a test of the search') + '\n' +
				'INSENSITIVE' + '\n',
				[
					[
						"../common/common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path",
						"..\\..\\common\\common_util_sql.c:canonical_full_start: Starting path not recognized.\nInvalid Path"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 1', 'websocket', '', 'FILE\tSEARCH\t/app/trusted_g/\tbran muffin\nRECURSIVE\n',
				[
					[
						"/test.txt:2:This is a test of the bran muffin. (test line #2)\n",
						"\\test.txt:2:This is a test of the bran muffin. (test line #2)\n"
					],
					[
						"/test/test.txt:2:This is a test of the bran muffin. (test line #2)\n",
						"\\test\\test.txt:2:This is a test of the bran muffin. (test line #2)\n"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 2', 'websocket', '', 'FILE\tSEARCH\t/app/trusted_g/\tBrAn mUfFiN\nINSENSITIVE\n',
				[
					[
						"/test.txt:2:This is a test of the bran muffin. (test line #2)\n",
						"\\test.txt:2:This is a test of the bran muffin. (test line #2)\n"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 3', 'websocket', '', 'FILE\tSEARCH\t/app/trusted_g/\tbran muffin\nREGEX\n',
				[
					[
						"/test.txt:2:This is a test of the bran muffin. (test line #2)\n",
						"\\test.txt:2:This is a test of the bran muffin. (test line #2)\n"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 4', 'websocket', '', 'FILE\tSEARCH\t' +
				GS.encodeForTabDelimited('/app/trusted_g/') + '\t' +
				GS.encodeForTabDelimited('This is a test of the [search|bran|envelope]') + '\n' +
				'INSENSITIVE\tREGEX\tRECURSIVE' + '\n',
				[
					[
						"/test.txt:1:This is a test of the search. (test line #1)\n",
						"\\test.txt:1:This is a test of the search. (test line #1)\n"
					],
					[
						"/test.txt:2:This is a test of the bran muffin. (test line #2)\n",
						"\\test.txt:2:This is a test of the bran muffin. (test line #2)\n"
					],
					[
						"/test.txt:4:This is a test of the envelope. (test line #4)\n",
						"\\test.txt:4:This is a test of the envelope. (test line #4)"
					],
					[
						"/test/test.txt:1:This is a test of the search. (test line #1)\n",
						"\\test\\test.txt:1:This is a test of the search. (test line #1)\n"
					],
					[
						"/test/test.txt:2:This is a test of the bran muffin. (test line #2)\n",
						"\\test\\test.txt:2:This is a test of the bran muffin. (test line #2)\n"
					],
					[
						"/test/test.txt:4:This is a test of the envelope. (test line #4)\n",
						"\\test\\test.txt:4:This is a test of the envelope. (test line #4)"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 5', 'websocket', '', 'FILE\tSEARCH\t' +
				GS.encodeForTabDelimited('/app/trusted_g/') + '\t' +
				GS.encodeForTabDelimited('This is a test of the [search|bran|envelope]') + '\n' +
				'INSENSITIVE\tREGEX' + '\n',
				[
					[
						"/test.txt:1:This is a test of the search. (test line #1)\n",
						"\\test.txt:1:This is a test of the search. (test line #1)\n"
					],
					[
						"/test.txt:2:This is a test of the bran muffin. (test line #2)\n",
						"\\test.txt:2:This is a test of the bran muffin. (test line #2)\n"
					],
					[
						"/test.txt:4:This is a test of the envelope. (test line #4)\n",
						"\\test.txt:4:This is a test of the envelope. (test line #4)"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 6', 'websocket', '', 'FILE\tSEARCH\t' +
				GS.encodeForTabDelimited('/app/trusted_g/') + '\t' +
				GS.encodeForTabDelimited('This....a test of the search') + '\n' +
				'INSENSITIVE\tREGEX' + '\n',
				[
					[
						"/test.txt:1:This is a test of the search. (test line #1)\n",
						"\\test.txt:1:This is a test of the search. (test line #1)\n"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 7', 'websocket', '', 'FILE\tSEARCH\t' +
				GS.encodeForTabDelimited('/app/trusted_g/') + '\t' +
				GS.encodeForTabDelimited('This is a test of the search'),
				[
					[
						"/test.txt:1:This is a test of the search. (test line #1)\n",
						"\\test.txt:1:This is a test of the search. (test line #1)\n"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH 8', 'websocket', '', 'FILE\tSEARCH\t' +
				GS.encodeForTabDelimited('/app/trusted_g/') + '\t' +
				GS.encodeForTabDelimited('This....a test of the search') + '\n' +
				'INSENSITIVE\tREGEX' + '\n',
				[
					[
						"/test.txt:1:This is a test of the search. (test line #1)\n",
						"\\test.txt:1:This is a test of the search. (test line #1)\n"
					],
					"TRANSACTION COMPLETED"
				]
			],
			['APP FILE SEARCH END', 'websocket', '', 'FILE\tDELETE\t/app/trusted_g/',
				['OK', 'TRANSACTION COMPLETED']]
		];

		Global.role_tests = JSON.parse(JSON.stringify(Global.app_tests));
		var i, len = Global.role_tests.length;
		for (i = 0; i < len; i++) {
			Global.role_tests[i][0] = Global.role_tests[i][0].replace(/APP/g, 'ROLE');
			Global.role_tests[i][0] = Global.role_tests[i][0].replace(/App/g, 'Role');
			Global.role_tests[i][3] = Global.role_tests[i][3].replace(/app/gi, 'role');
			if (typeof (Global.app_tests[i][5]) === 'function') {
					Global.role_tests[i][5] = Global.app_tests[i][5];
			}
			if (typeof (Global.role_tests[i][4]) === 'string') {
				Global.role_tests[i][4] = Global.role_tests[i][4].replace(/app/gi, 'role');
			} else {
				var role_i, role_len = Global.role_tests[i][4].length;
				for (role_i = 0; role_i < role_len; role_i++) {
					if (typeof (Global.role_tests[i][4][role_i]) === 'string') {
						Global.role_tests[i][4][role_i] = Global.role_tests[i][4][role_i].replace(/app/gi, 'role');
					} else {
						var role_j, role_len2 = Global.role_tests[i][4][role_i].length;
						for (role_j = 0; role_j < role_len2; role_j++) {
							Global.role_tests[i][4][role_i][role_j] = Global.role_tests[i][4][role_i][role_j].replace(/app/gi, 'role');
						}
					}
				}
			}
		}
		console.log('test6');
		
		Global.web_root_tests = JSON.parse(JSON.stringify(Global.app_tests));
		var i, len = Global.web_root_tests.length;
		for (i = 0; i < len; i++) {
			Global.web_root_tests[i][0] = Global.web_root_tests[i][0].replace(/APP/g, 'WEB_ROOT');
			Global.web_root_tests[i][0] = Global.web_root_tests[i][0].replace(/App/g, 'Web_root');
			Global.web_root_tests[i][3] = Global.web_root_tests[i][3].replace(/env\/app\/all\//gi, '');
			Global.web_root_tests[i][3] = Global.web_root_tests[i][3].replace(/app/gi, 'web_root');
			Global.web_root_tests[i][3] = Global.web_root_tests[i][3].replace(/all\//gi, '');
			if (typeof (Global.app_tests[i][5]) === 'function') {
				Global.web_root_tests[i][5] = Global.app_tests[i][5];
			}
			if (typeof (Global.web_root_tests[i][4]) === 'string') {
				Global.web_root_tests[i][4] = Global.web_root_tests[i][4].replace(/env\/app\/all\//gi, '');
				Global.web_root_tests[i][4] = Global.web_root_tests[i][4].replace(/app/gi, 'web_root');
				Global.web_root_tests[i][4] = Global.web_root_tests[i][4].replace(/all\//gi, '');
			} else {
				var web_root_i, web_root_len = Global.web_root_tests[i][4].length;
				for (web_root_i = 0; web_root_i < web_root_len; web_root_i++) {
					if (typeof (Global.web_root_tests[i][4][web_root_i]) === 'string') {
						Global.web_root_tests[i][4][web_root_i] = Global.web_root_tests[i][4][web_root_i].replace(/env\\app\\all\\/gi, '');
						Global.web_root_tests[i][4][web_root_i] = Global.web_root_tests[i][4][web_root_i].replace(/env\/app\/all\//gi, '');
						Global.web_root_tests[i][4][web_root_i] = Global.web_root_tests[i][4][web_root_i].replace(/app/gi, 'web_root');
						Global.web_root_tests[i][4][web_root_i] = Global.web_root_tests[i][4][web_root_i].replace(/all\\/gi, '');
						Global.web_root_tests[i][4][web_root_i] = Global.web_root_tests[i][4][web_root_i].replace(/all\//gi, '');
					} else {
						var web_root_j, web_root_len2 = Global.web_root_tests[i][4][web_root_i].length;
						for (web_root_j = 0; web_root_j < web_root_len2; web_root_j++) {
							Global.web_root_tests[i][4][web_root_i][web_root_j] = Global.web_root_tests[i][4][web_root_i][web_root_j].replace(/env\\app\\all\\/gi, '');
							Global.web_root_tests[i][4][web_root_i][web_root_j] = Global.web_root_tests[i][4][web_root_i][web_root_j].replace(/env\/app\/all\//gi, '');
							Global.web_root_tests[i][4][web_root_i][web_root_j] = Global.web_root_tests[i][4][web_root_i][web_root_j].replace(/app/gi, 'web_root');
							Global.web_root_tests[i][4][web_root_i][web_root_j] = Global.web_root_tests[i][4][web_root_i][web_root_j].replace(/all\\/gi, '');
							Global.web_root_tests[i][4][web_root_i][web_root_j] = Global.web_root_tests[i][4][web_root_i][web_root_j].replace(/all\//gi, '');
						}
					}
				}
			}
		}
		console.log('test7');

		//Global.tests = Global.tests + Global.app_tests + Global.role_tests + Global.web_root_tests;
		Global.tests.push.apply(Global.tests, Global.app_tests);
		Global.tests.push.apply(Global.tests, Global.role_tests);
		Global.tests.push.apply(Global.tests, Global.web_root_tests);
		console.log('test8');
		
		Global.tests.push.apply(Global.tests, [
			['RAW FAIL', 'websocket', '', ml(function () {/*RAW*/}),
				["Invalid Request Type \"RAW\"\n"]],
			['ACTION RESET SEQ', 'websocket', '', ml(function () {/*ACTION	public	action_reset_seq	
*/}),
				["\"\"\n", "TRANSACTION COMPLETED"]],

			['ACCEPT FAIL', 'ajax', 500, '/env/public.accept_testing1', 'testingnitset', ml(function () {/*"FATAL\nDB_exec failed:\nFATAL\nerror_text\tERROR:  function public.accept_testing1(unknown) does not exist\\nLINE 1: SELECT public.accept_testing1('testingnitset');\\n               ^\\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\\n\nerror_detail\t\nerror_hint\tNo function matches the given name and argument types. You might need to add explicit type casts.\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })],
			['ACCEPT 1', 'ajax', 200, '/env/public.accept_testing', 'testingnitset', 'testingnitset'],
			['ACCEPT 2', 'ajax', 200, '/env/public.accept_testing', 'company_name=AA-TULSA&company_name_exact=0&type=Passenger&type_anywhere=-1&engine_mfg=Pratt %26 Whitney&engine_mfg_exact=0&engine_model=J57-P&engine_model_exact=0&country=&country_exact=0&continent=&continent_exact=0&overhaul_center=&overhaul_center_exact=0&on_order=undefined&stored=undefined', 'company_name=AA-TULSA&company_name_exact=0&type=Passenger&type_anywhere=-1&engine_mfg=Pratt %26 Whitney&engine_mfg_exact=0&engine_model=J57-P&engine_model_exact=0&country=&country_exact=0&continent=&continent_exact=0&overhaul_center=&overhaul_center_exact=0&on_order=undefined&stored=undefined'],
			['ACCEPTNC FAIL', 'ajax', 500, '/env/public.acceptnc_testing1', 'testingnitset', ml(function () {/*"FATAL\nDB_exec failed:\nFATAL\nerror_text\tERROR:  function public.acceptnc_testing1(unknown) does not exist\\nLINE 1: SELECT public.acceptnc_testing1('testingnitset');\\n               ^\\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\\n\nerror_detail\t\nerror_hint\tNo function matches the given name and argument types. You might need to add explicit type casts.\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })],
			['ACCEPTNC', 'ajax', 200, '/env/public.acceptnc_testing', 'testingnitset', 'testingnitset'],
			['ACTION FAIL', 'ajax', 500, '/env/public.action_testing1', 'testingnitset', ml(function () {/*"FATAL\nDB_exec failed, res->status == 5:\nFATAL\nerror_text\tERROR:  function public.action_testing1(unknown) does not exist\\nLINE 1: SELECT public.action_testing1('testingnitset');\\n               ^\\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\\n\nerror_detail\t\nerror_hint\tNo function matches the given name and argument types. You might need to add explicit type casts.\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })],
			['ACTION', 'ajax', 200, '/env/public.action_testing', 'testingnitset', '{"stat":true, "dat": "testingnitset"}'],
			['ACTIONNC FAIL', 'ajax', 500, '/env/public.actionnc_testing1', 'testingnitset', ml(function () {/*"FATAL\nDB_exec failed, res->status == 5:\nFATAL\nerror_text\tERROR:  function public.actionnc_testing1(unknown) does not exist\\nLINE 1: SELECT public.actionnc_testing1('testingnitset');\\n               ^\\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\\n\nerror_detail\t\nerror_hint\tNo function matches the given name and argument types. You might need to add explicit type casts.\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })],
			['ACTIONNC', 'ajax', 200, '/env/public.actionnc_testing', 'testingnitset', '{"stat":true, "dat": "testingnitset"}'],
			['action_info', 'ajax', 200, '/env/action_info', '',
				function (arg) {
					return arg === ml(function () {/*{"stat": true, "dat": {"username": "postgres", "session_user": "postgres", "current_user": "postgres", "groups": ["developer_g"], "port": 8888, "database_version": "PostgreSQL 9.5.4 on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 6.1.1 20160621 (Red Hat 6.1.1-3), 64-bit","envelope": "2.2.1"}}*/ })
						|| arg === ml(function () {/*{"stat": true, "dat": {"username": "postgres", "session_user": "postgres", "current_user": "postgres", "groups": ["developer_g"], "port": 8888, "database_version": "PostgreSQL 9.5.2, compiled by Visual C++ build 1800, 64-bit","envelope": "3.1.3"}}*/ })
				}
			],
			['ACTION FAIL 1', 'websocket', '', ml(function () {/*ACTION	public	action_testing1	testingnitset
*/}),
			["FATAL\nerror_text\tERROR:  function public.action_testing1(unknown) does not exist\\nLINE 1: COPY (SELECT \"public\".\"action_testing1\"('testingnitset')) TO...\\n                     ^\\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\\n\nerror_detail\t\nerror_hint\tNo function matches the given name and argument types. You might need to add explicit type casts.\nerror_query\t\nerror_context\t\nerror_position\t14\n"]],
			['ACTION FAIL 2', 'websocket', '', ml(function () {/*ACTION	public	actiont_testing1	testingnitset
*/}),
			["Invalid action name, action function names must begin with \"action_\""]],
			['ACTION FAIL 3', 'websocket', '', ml(function () {/*ACTION	actiont_testing1	testingnitset
*/}),
			["Invalid action name, action function names must begin with \"action_\""]],
			['ACTION FAIL 4', 'websocket', '', ml(function () {/*ACTION	public actiont_testing1	testingnitset
*/}),
			["Invalid action name, action function names must begin with \"action_\""]],
			['ACTION', 'websocket', '', ml(function () {/*ACTION	public	action_testing	testingnitset
*/}),
			["\"testingnitset\"\n", "TRANSACTION COMPLETED"]],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['UPDATE NO RECORDS', 'websocket', '', ml(function () {/*UPDATE	rtesting_table
RETURN	id	test_name
HASH	id

pk	set	hash
id	test_name	hash
2	Bobby	c81e728d9d4c2f636f067f89cc14862c
3	Alicia	eccbc87e4b5ce2fe28308fd9f2a7baf3
*/}),
				[["Some of these records have already been deleted.:\nFATAL\nerror_text\t\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t\n"]]],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['DELETE NO RECORDS', 'websocket', '', ml(function () {/*DELETE	rtesting_table
HASH	id

pk	hash
id	hash
2	c81e728d9d4c2f636f067f89cc14862c
3	eccbc87e4b5ce2fe28308fd9f2a7baf3
*/}),
				[["Some of these records have already been deleted.:\nFATAL\nerror_text\t\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t\n"]]],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['SELECT FAIL', 'websocket', '', ml(function () {/*SELECT	rtesting_table
RETURN	id	test_name	test_full

ORDER BY
id DESC
*/}),
				[
					[
						"../db_framework_pq/db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  column rtesting_table.test_full does not exist\\nLINE 1: ...esting_table\".\"id\", \"rtesting_table\".\"test_name\", \"rtesting_...\\n                                                             ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t61\n",
						"..\\..\\db_framework_pq\\db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  column rtesting_table.test_full does not exist\\nLINE 1: ...esting_table\".\"id\", \"rtesting_table\".\"test_name\", \"rtesting_...\\n                                                             ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t61\n"
					]
				]
			],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['SELECT', 'websocket', '', ml(function () {/*SELECT	rtesting_table
RETURN	id	test_name	test_name2

ORDER BY
id DESC
*/}),
				['id\ttest_name\ttest_name2\ninteger\tcharacter varying(150)\tcharacter varying(150)\n']],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['INSERT FAIL 1', 'websocket', '', ml(function () {/*INSERT	rtesting_table
RETURN	id	test_name	test_name2
PK	id
SEQ	id

test_name	test_name2
Bob	Robert
Alice	Alicia
Eve	Adam
*/}),
				["DB_exec failed:\nFATAL\nerror_text\tERROR:  relation \"id\" does not exist\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t\n"]],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['INSERT FAIL 2', 'websocket', '', ml(function () {/*INSERT	ttesting_view
RETURN	id	test_name
PK	id
SEQ

id	test_name
1	Bob
2	Alice
3	Eve
*/}),
				["DB_exec failed:\nFATAL\nerror_text\tERROR:  cannot insert into view \"ttesting_view\"\\nDETAIL:  Views that do not select from a single table or view are not automatically updatable.\\nHINT:  To enable inserting into the view, provide an INSTEAD OF INSERT trigger or an unconditional ON INSERT DO INSTEAD rule.\\n\nerror_detail\tViews that do not select from a single table or view are not automatically updatable.\nerror_hint\tTo enable inserting into the view, provide an INSTEAD OF INSERT trigger or an unconditional ON INSERT DO INSTEAD rule.\nerror_query\t\nerror_context\t\nerror_position\t\n"]],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['INSERT FAIL 3', 'websocket', '', ml(function () {/*INSERT	rtesting_table
RETURN	id	test_name
PK	id
SEQ

id	test_name
*/}),
				["No insert data:\nFATAL\nerror_text\t\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t\n"]],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['INSERT 1', 'websocket', '', ml(function () {/*INSERT	rtesting_table
RETURN	id	test_name	test_name2
PK	id
SEQ

test_name	test_name2
Bob	
*/}),
				["2\tBob\t\n","TRANSACTION COMPLETED"]],
			['COMMIT', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['INSERT 2', 'websocket', '', ml(function () {/*INSERT	rtesting_table
RETURN	id	test_name	test_name2
PK	id
SEQ

test_name	test_name2
Alice	Alicia
Eve	Adam
*/}),
				["3\tAlice\tAlicia\n4\tEve\tAdam\n","TRANSACTION COMPLETED"]],
			['COMMIT', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],
			['SELECT', 'websocket', '', ml(function () {/*SELECT	rtesting_table
RETURN	id	test_name	test_name2

LIMIT	OFFSET
2	1
*/}),
				["id\ttest_name\ttest_name2\ninteger\tcharacter varying(150)\tcharacter varying(150)\n","3\tAlice\tAlicia\n4\tEve\tAdam\n","TRANSACTION COMPLETED"]],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['SELECT', 'websocket', '', ml(function () {/*SELECT	rtesting_table
RETURN	id	test_name	test_name2

LIMIT
2
*/}),
				["id\ttest_name\ttest_name2\ninteger\tcharacter varying(150)\tcharacter varying(150)\n","2\tBob\t\n3\tAlice\tAlicia\n","TRANSACTION COMPLETED"]],
			['SELECT', 'websocket', '', ml(function () {/*SELECT	rtesting_table
RETURN	id	test_name	test_name2

OFFSET
2
*/}),
				["id\ttest_name\ttest_name2\ninteger\tcharacter varying(150)\tcharacter varying(150)\n","4\tEve\tAdam\n","TRANSACTION COMPLETED"]],
			['COMMIT', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],

			['Select Fail 1', 'ajax', 500, '/env/action_select', 'src=rtesting_table1',
				function (arg) {
					return arg === ml(function () {/*"FATAL\n../db_framework_pq/db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t73\n"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\db_framework_pq\\db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t73\n"*/ })
				}
			],
			['Select Fail 2', 'ajax', 500, '/env/action_select', 'view=rtesting_table1',
				function (arg) {
					return arg === ml(function () {/*"FATAL\n../db_framework_pq/db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t73\n"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\db_framework_pq\\db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t73\n"*/ })
				}
			],
			['Select 1', 'ajax', 200, '/env/action_select', 'src=rtesting_table&limit=1&order_by=id%20ASC',
				ml(function () {/*{"stat": true, "dat": {"arr_column": ["id","test_name","test_name2","change_stamp"], "dat": [[2,"Bob","","2016-07-12 05:13:00"]], "row_count": 3}}*/})],

			['Select 2', 'ajax', 200, '/env/action_select', 'view=SELECT * FROM rtesting_table&limit=1&order_by=id%20ASC',
				ml(function () {/*{"stat": true, "dat": {"arr_column": ["id","test_name","test_name2","change_stamp"], "dat": [[2,"Bob","","2016-07-12 05:13:00"]], "row_count": 3}}*/})],
			['Select 3', 'ajax', 200, '/env/action_select', 'src=(SELECT * FROM rtesting_table) em&limit=1&order_by=id%20ASC&where=id%20%3D%206',
				ml(function () {/*{"stat": true, "dat": {"arr_column": ["id","test_name","test_name2","change_stamp"], "dat": [], "row_count": 0}}*/})],
			['Select 4', 'ajax', 200, '/env/action_select', 'src=generate_series(1,10)',
				ml(function () {/*{"stat": true, "dat": {"arr_column": ["generate_series"], "dat": [[1],[2],[3],[4],[5],[6],[7],[8],[9],[10]], "row_count": 10}}*/})],
			['Select 5', 'ajax', 200, '/env/action_select', 'src=generate_series(1,20)',
				ml(function () {/*{"stat": true, "dat": {"arr_column": ["generate_series"], "dat": [[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20]], "row_count": 20}}*/})],
			['Select 6', 'ajax', 200, '/env/action_select', 'src=generate_series(1,16300)',
				ml(function () {/*{"stat": true, "dat": {"arr_column": ["generate_series"], "dat": [*/}) + '[' + makeArray(16300, function (i) { return i + 1;}).join('],[') + ']' + ml(function () {/*], "row_count": 16300}}*/})],
			['Insert Fail 1', 'ajax', 500, '/env/action_insert', 'src=rtesting_table1&data=id%3D1',
				function (arg) {
					return arg === ml(function () {/*"FATAL\n../db_framework_pq/db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1;\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t19\n"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\db_framework_pq\\db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1;\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t19\n"*/ })
				}
			],
			['Insert Fail 2', 'ajax', 500, '/env/action_insert', 'view=rtesting_table1&data=id%3D1',
				function (arg) {
					return arg === ml(function () {/*"FATAL\n../db_framework_pq/db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1;\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t19\n"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\db_framework_pq\\db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 2:    FROM rtesting_table1;\\n                ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t19\n"*/ })
				}
			],
            ['Insert Fail 3', 'ajax', 500, '/env/action_insert', 'src=rtesting_table',
                ml(function () {/*"FATAL\nNo insert data"*/ })],
			['Insert 1', 'ajax', 200, '/env/action_insert', 'src=rtesting_table&data=' + encodeURIComponent('test_name=test&test_name2=test'),
				ml(function () {/*{"stat": true, "dat": {"lastval": 5}}*/})],
			['Insert 2', 'ajax', 200, '/env/action_insert', 'view=rtesting_table&data=' + encodeURIComponent('test_name=test&test_name2=test'),
				ml(function () {/*{"stat": true, "dat": {"lastval": 6}}*/})],
			['Update Fail', 'ajax', 500, '/env/action_update', 'src=rtesting_table&column=first_name&value=Test&where=' + encodeURIComponent('id=5'),
				function (arg) {
					return arg === ml(function () {/*"FATAL\n../db_framework_pq/db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  column \"first_name\" does not exist\\nLINE 1: SELECT \"first_name\", \"id\", * FROM rtesting_table\\n               ^\\nHINT:  Perhaps you meant to reference the column \"rtesting_table.test_name\".\\n\nerror_detail\t\nerror_hint\tPerhaps you meant to reference the column \"rtesting_table.test_name\".\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })
						|| arg === ml(function () {/*"FATAL\n..\\..\\db_framework_pq\\db_framework.c:DB_get_column_types_for_query2: DB_get_column_types_for_query failed\nQuery failed:\nFATAL\nerror_text\tERROR:  column \"first_name\" does not exist\\nLINE 1: SELECT \"first_name\", \"id\", * FROM rtesting_table\\n               ^\\nHINT:  Perhaps you meant to reference the column \"rtesting_table.test_name\".\\n\nerror_detail\t\nerror_hint\tPerhaps you meant to reference the column \"rtesting_table.test_name\".\nerror_query\t\nerror_context\t\nerror_position\t8\n"*/ })
				}],
			['Update 1', 'ajax', 200, '/env/action_update', 'src=rtesting_table&column=test_name&value=Test&where=' + encodeURIComponent('id=5'),
				ml(function () {/*{"stat": true, "dat": ["5","Test","test","2016-07-12 05:13:00"]}*/})],
			['Update 2', 'ajax', 200, '/env/action_update', 'src=rtesting_table&column=test_name&value=NULL&where=' + encodeURIComponent('id=5&change_stamp=2016-07-12%2005:13:00'),
				ml(function () {/*{"stat": true, "dat": ["5",null,"test","2016-07-12 05:13:00"]}*/})],
			['Update 3', 'ajax', 200, '/env/action_update', 'view=rtesting_table&column=test_name&value=NULL&where=' + encodeURIComponent('id=5&change_stamp=2016-07-12%2005:13:00'),
				ml(function () {/*{"stat": true, "dat": ["5",null,"test","2016-07-12 05:13:00"]}*/})],
			['Update 4', 'ajax', 200, '/env/action_update', 'src=rtesting_table&column=test_name&value=NU\nLL&where=' + encodeURIComponent('id=5&change_stamp=2016-07-12%2005:13:00'),
				ml(function () {/*{"stat": true, "dat": ["5","NU\nLL","test","2016-07-12 05:13:00"]}*/})],
			['Delete Fail', 'ajax', 500, '/env/action_delete', 'src=rtesting_table1&id=5',
				ml(function () {/*"FATAL\nDB_exec failed:\nFATAL\nerror_text\tERROR:  relation \"rtesting_table1\" does not exist\\nLINE 1: DELETE FROM rtesting_table1 WHERE id IN (5);\\n                    ^\\n\nerror_detail\t\nerror_hint\t\nerror_query\t\nerror_context\t\nerror_position\t13\n"*/})],
			['Delete 1', 'ajax', 200, '/env/action_delete', 'src=rtesting_table&id=5',
				ml(function () {/*{"stat": true, "dat": ""}*/})],
			['Delete 2', 'ajax', 200, '/env/action_delete', 'view=rtesting_table&id=6',
				ml(function () {/*{"stat": true, "dat": ""}*/})],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/}),
				['OK']],
			['UPDATE FAIL 1', 'websocket', '', ml(function () {/*UPDATE	rtesting_table
RETURN	id	tes_name

pk	set
id	test_name
2	Bobby
3	Alicia
*/}),
				["FATAL\nerror_text\tERROR:  column rtesting_table.tes_name does not exist\\nLINE 1: COPY (SELECT \"rtesting_table\".\"id\", \"rtesting_table\".\"tes_na...\\n                                            ^\\nHINT:  Perhaps you meant to reference the column \"rtesting_table.test_name\".\\n\nerror_detail\t\nerror_hint\tPerhaps you meant to reference the column \"rtesting_table.test_name\".\nerror_query\t\nerror_context\t\nerror_position\t37\n"]],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['UPDATE FAIL 2', 'websocket', '', ml(function () {/*UPDATE	ttesting_view
RETURN	id	test_name

pk	set
id	test_name
2	Bobby
3	Alicia
*/}),
				[
					["DB_exec failed:\nFATAL\nerror_text\tERROR:  cannot update view \"ttesting_view\"\\nDETAIL:  Views that do not select from a single table or view are not automatically updatable.\\nHINT:  To enable updating the view, provide an INSTEAD OF UPDATE trigger or an unconditional ON UPDATE DO INSTEAD rule.\\n\nerror_detail\tViews that do not select from a single table or view are not automatically updatable.\nerror_hint\tTo enable updating the view, provide an INSTEAD OF UPDATE trigger or an unconditional ON UPDATE DO INSTEAD rule.\nerror_query\t\nerror_context\t\nerror_position\t\n"]
				]],
			['ROLLBACK', 'websocket', '', ml(function () {/*ROLLBACK*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['UPDATE 1', 'websocket', '', ml(function () {/*UPDATE	rtesting_table
RETURN	id	test_name

pk	set
id	test_name
2	Bobbys
3	Alicias
*/}),
				['2\tBobbys\n3\tAlicias\n', 'TRANSACTION COMPLETED']],
			['COMMIT', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['UPDATE 2', 'websocket', '', ml(function () {/*UPDATE	rtesting_table
RETURN	id	test_name

pk	set
id	test_name
2	Bobby
3	Alicia
*/}),
				['2\tBobby\n3\tAlicia\n', 'TRANSACTION COMPLETED']],
			['COMMIT', 'websocket', '', ml(function () {/*COMMIT*/}),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/}),
				['OK']],
			['DELETE FAIL 1', 'websocket', '', ml(function () {/*DELETE rtesting_table
pk
id
2
3
4
*/}),
				[
					[
						"../common/common_util_sql.c:get_table_name: Invalid request\nFailed to get table name from query",
						"..\\..\\common\\common_util_sql.c:get_table_name: Invalid request\nFailed to get table name from query"
					]
				]
			],
			['ROLLBACK', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['DELETE FAIL 2', 'websocket', '', ml(function () {/*DELETE	ttesting_view

pk
id
2
3
4
*/}),
				[
					["DB_exec failed:\nFATAL\nerror_text\tERROR:  cannot delete from view \"ttesting_view\"\\nDETAIL:  Views that do not select from a single table or view are not automatically updatable.\\nHINT:  To enable deleting from the view, provide an INSTEAD OF DELETE trigger or an unconditional ON DELETE DO INSTEAD rule.\\n\nerror_detail\tViews that do not select from a single table or view are not automatically updatable.\nerror_hint\tTo enable deleting from the view, provide an INSTEAD OF DELETE trigger or an unconditional ON DELETE DO INSTEAD rule.\nerror_query\t\nerror_context\t\nerror_position\t\n"]
				]],
			['ROLLBACK', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['DELETE 1', 'websocket', '', ml(function () {/*DELETE	rtesting_table

pk
id
2
*/}),
				['Rows Affected\n1\n', 'TRANSACTION COMPLETED']],
			['COMMIT', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],
			['BEGIN', 'websocket', '', ml(function () {/*BEGIN*/ }),
				['OK']],
			['DELETE 2', 'websocket', '', ml(function () {/*DELETE	rtesting_table

pk
id
3
4
*/}),
				['Rows Affected\n2\n', 'TRANSACTION COMPLETED']],
			['COMMIT', 'websocket', '', ml(function () {/*COMMIT*/ }),
				['OK']],
			['WEBSOCKET CLOSE', 'websocket end', '', '', ''],

			['Logout', 'ajax', 200, '/env/auth', 'action=logout',
				ml(function () {/*<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-GB">
<head><script>window.open('/', '_self');</scr*/}) + ml(function () {/*ipt></head><body></body></html>*/ })]
				]);
				Local.tests = JSON.parse(JSON.stringify(Global.tests));
				Local.tests[35][4] = new Blob(['action=login&connname=test&username=postgres&password=password'], {type: 'text/plain'});
				Local.tests[36][4] = new Blob(['action=login&connname=test&username=postgres&password=password'], {type: 'application/octet-binary'});
				Local.tests[37][4] = new Blob(['action=login&connname=test&username=postgres&password=password'], { type: 'application/x-binary' });
				for (i = 0, len = Local.tests.length; i < len; i++) {
					if (typeof (Global.tests[i][5]) === 'function') {
						Local.tests[i][5] = Global.tests[i][5];
					}
				}
				//application/octet-binary
				//ml(function () {/*asdfasdfasdf*/})
				window.addEventListener('load', function () {
					var i, len;
					var strHTML = '';
					for (i = 0, len = Local.tests.length; i < len; i++) {
						var arrCurrent = Local.tests[i];
						var strName = arrCurrent[0];
						strHTML +=
							'<gs-block id="test' + i + '_label" class="waiting">' +
								'<label>' + strName + '</label>' +
							'</gs-block>';
					}
					document.getElementById('gridtests').innerHTML =
		                '<gs-grid min-width="all {reflow}; sml {1,1,1}; med {1,1,1,1,1}; lrg {1,1,1,1,1,1,1,1};">' +
		                    strHTML +
		                '</gs-grid>';
					GS.ajaxText('/index.html', '', function (data, error) {
						if (!error) {
							for (i = 0, len = Global.tests.length; i < len; i++) {
								if (Global.tests[i][0].indexOf('Logout') === 0) {
									Local.tests[i][5] = data;
									Global.tests[i][5] = data;
								}
							}
							run_test(0);
						} else {
							change_status(0, 'waiting', 'error');
							document.getElementById('actual_status').value = ajax.status;
							document.getElementById('actual_output').value = data.error_text;
						}
					});
		            
		            window.addEventListener('keydown', function (event) {
		                if ((event.metaKey || event.ctrlKey) && ((event.keyCode || event.which) === 82)) {
		                    event.preventDefault();
		                    window.location = '/test.html';
		                }
		            });

		            document.getElementById('gridtests').firstElementChild.addEventListener('click', function (event) {
		            	console.log('event.target:', event.target);
		            	GS.openDialogToElement(
							event.target, // element to position too
							'errorDialog', // template for the dialog
							'right', // side that the dialog should try to go to
									 //   if the dialog can't go on that side it
									 //   will try other sides
						function () {
							document.getElementById('errorDialogHeader').innerHTML = event.target.parentElement.strStatus;
							document.getElementById('errorDialogContent').value = event.target.parentElement.strErrorText;
							// after open, same as GS.openDialog
						}, function (event, strAnswer) {
							// before close, same as GS.openDialog
						});
		            });
				});
				function change_status(intCurrent, strOldClass, strNewClass, strStatus, strErrorText) {
					var objLabel = document.getElementById('test' + intCurrent + '_label');
					objLabel.classList.remove(strOldClass);
					objLabel.classList.add(strNewClass);
					if (strNewClass === 'fail') {
						//GS.pushState({}, 'Postage Test Backend', '/test.html');
		                //GS.scrollIntoView(objLabel);
		                document.getElementById('status-note').textContent = ' (ERROR)';
					} else {
		                document.getElementById('status-note').textContent = ' (RUNNING)';
					}
					objLabel.strStatus = strStatus;
					objLabel.strErrorText = strErrorText;
				}
				/*
				Object.prototype.toString = function () {
					return JSON.stringify(this, true, 4);
				};
				*/
				var bol_run = true, bol_refresh = false;
				function run_test(intCurrent) {
					console.log('run_test:', intCurrent);
					var arrCurrent = Local.tests[intCurrent];
					if (arrCurrent === undefined) {
						if (bol_run) {
							test_random = Math.random().toString().substring(2);
							Local.tests = JSON.parse(JSON.stringify(Global.tests));

							for (i = 0, len = Local.tests.length; i < len; i++) {
								change_status(i, 'pass', 'waiting');
								console.log(Local.tests[i][3], Local.tests[i][4]);
								if (typeof(Global.tests[i][5]) === 'function') {
									Local.tests[i][5] = Global.tests[i][5];
								} else if (Global.tests[i][0] === 'Login 2') {
									Local.tests[i][4] = new Blob(['action=login&connname=test&username=postgres&password=password'], { type: 'text/plain' });
								} else if (Global.tests[i][0] === 'Login 3') {
									Local.tests[i][4] = new Blob(['action=login&connname=test&username=postgres&password=password'], { type: 'application/octet-binary' });
								} else if (Global.tests[i][0] === 'Login 4') {
									Local.tests[i][4] = new Blob(['action=login&connname=test&username=postgres&password=password'], { type: 'application/x-binary' });
								}
							}

							run_test(0);
						} else {
		                    document.getElementById('status-note').textContent = ' (STOPPED)';
							GS.pushState({}, 'Postage Test Backend', '/test.html');
						}
		                
		                if (bol_refresh === true) {
		                    window.location = '/test.html';
		                }
		                
						var num = parseInt(document.getElementById('iterations').innerText, 10);
						document.getElementById('iterations').innerText = num + 1;
						return;
					}
					var strType = arrCurrent[1], intStatusCode, strLink, strArgs, strExpectedOutput, i, arrStrActualOutput, expectedOutput;
					if (strType === 'ajax') {
						console.log('ASDFASDFASDFASDF');
						if (typeof (arrCurrent[5]) === 'string') {
							arrCurrent[5] = arrCurrent[5].replace(/\r\n/gi, '\n');
						}

						var intStatusCode = arrCurrent[2];
						var strLink = arrCurrent[3];
						var strArgs = arrCurrent[4];
						var expectedOutput = arrCurrent[5];
						change_status(intCurrent, 'waiting', 'running');
						/*
						var ajax = GS.ajaxText(strLink, strArgs, function (data, error) {
							//console.log('>' + intCurrent + '|' + data + '|' + error + '<');
							//console.log(data.error_text);
							//console.log(strExpectedOutput);
							//console.log(data.error_text);
							if (!error) {
								data = data.replace(/\r\n/gi, '\n');
								if (data === strExpectedOutput && intStatusCode === ajax.status) {
									change_status(intCurrent, 'running', 'pass', ajax.status, data);
									run_test(intCurrent + 1);
								} else {
									change_status(intCurrent, 'running', 'fail', ajax.status, data);
									document.getElementById('actual_status').value = ajax.status;
									document.getElementById('actual_output').value = data;
									run_test(intCurrent + 1);
								}
							} else {
								if (data.error_text === strExpectedOutput && intStatusCode === ajax.status) {
									change_status(intCurrent, 'running', 'pass', ajax.status, data.error_text);
									run_test(intCurrent + 1);
								} else {
									change_status(intCurrent, 'running', 'fail', ajax.status, data.error_text);
									document.getElementById('actual_status').value = ajax.status;
									document.getElementById('actual_output').value = data.error_text;
									run_test(intCurrent + 1);
								}
							}
						});
						*/
						console.log('E##########################', strArgs);
						var ajax = GS.ajaxText(strLink, strArgs, function (data, error) {
							var strResult;
							var bolMatch;

							if (!error) {
								strResult = data.replace(/\r\n/gi, '\n');
							} else {
								strResult = data.error_text;
							}

							if (typeof expectedOutput === 'function') {
								bolMatch = (expectedOutput(strResult));
							} else {
								bolMatch = (strResult === expectedOutput);
							}
							console.log(expectedOutput, strResult, bolMatch);

							if (bolMatch && intStatusCode === ajax.status) {
								change_status(intCurrent, 'running', 'pass');
							} else {
								document.getElementById('actual_status').value = ajax.status;
								document.getElementById('actual_output').value = strResult;
								change_status(intCurrent, 'running', 'fail', ajax.status, strResult);
							}
							run_test(intCurrent + 1);
						});
					} else if (strType === 'ajax spam') {
						if (typeof arrCurrent[5] === 'string') {
							arrCurrent[5] = arrCurrent[5].replace(/\r\n/gi, '\n');
						}

						intStatusCode = arrCurrent[2];
						strLink = arrCurrent[3];
						strArgs = arrCurrent[4];
						expectedOutput = arrCurrent[5];
						change_status(intCurrent, 'waiting', 'running');

						var error_occurred = false;
						i = 1, len = 100;
						while (i <= len) {
							(function (i) {
								var ajax = GS.ajaxText(strLink, strArgs, function (data, error) {
									var strResult;
									var bolMatch;

									//if (!error_occurred) {
									if (!error) {
										strResult = data.replace(/\r\n/gi, '\n');
									} else {
										strResult = data.error_text;
									}
									if (typeof expectedOutput === 'function') {
										bolMatch = (expectedOutput(strResult));
									} else {
										bolMatch = (strResult === expectedOutput);
									}

									if (bolMatch && intStatusCode === ajax.status) {
										if (i == 100) {
											change_status(intCurrent, 'running', 'pass');
										}
									} else {
										error_occurred = true;
										//console.log('>' + intCurrent + '|' + data + '|' + error + '<');
										console.log(ajax.status, data);
										console.log(intStatusCode, strExpectedOutput);
										//console.log(data.error_text);
										change_status(intCurrent, 'running', 'fail', i, strResult);
										document.getElementById('actual_status').value = i;
										document.getElementById('actual_output').value = strResult;
									}
									if (i == 100) {
										run_test(intCurrent + 1);
									}
									//}
								});
							})(i)
							i += 1;
						}
					} else if (strType === 'upload') {
						arrCurrent[5] = arrCurrent[5].replace(/\r\n/gi, '\n');
						var intStatusCode = arrCurrent[2];
						var strLink = arrCurrent[3];
						var strArgs = arrCurrent[4];
						var strExpectedOutput = arrCurrent[5];
						change_status(intCurrent, 'waiting', 'running');
						var formData = new FormData();
						var blob = new Blob(['SELECT \'This is \0some\n\n tesr\r\n\r\nt \r\rsql\';'], { type: 'application/binary' });
						formData.append('file_name', strArgs);
						formData.append('file_content', blob);
						var request = new XMLHttpRequest();
						request.open('POST', strLink);
						request.onload = function () {
							request.response = request.response.replace(/\r\n/gi, '\n');
							if (request.response === strExpectedOutput && intStatusCode === request.status) {
								change_status(intCurrent, 'running', 'pass', request.status, request.response);
								run_test(intCurrent + 1);
							} else {
								change_status(intCurrent, 'running', 'fail', request.status, request.response);
								document.getElementById('actual_status').value = request.status;
								document.getElementById('actual_output').value = request.response;
								run_test(intCurrent + 1);
							}
						};
						request.send(formData);
					} else if (strType === 'websocket start') {
						change_status(intCurrent, 'waiting', 'running');
						GS.envSocket = GS.openSocket('/env/1/env');
						var i = 0;
						GS.requestFromSocket(GS.envSocket, 'INFO', function (data, error, errorData) {
							if (i === -1) {
								return;
							}
							i = -1;
							if (!error) {
								GS.envSocket.stayClosed = true;
								change_status(intCurrent, 'running', 'pass', 0, JSON.stringify(data));
								run_test(intCurrent + 1);
							} else {
								change_status(intCurrent, 'running', 'fail', 0, JSON.stringify(errorData));
								document.getElementById('actual_output').value = JSON.stringify(errorData);
								run_test(intCurrent + 1);
							}
						});
					} else if (strType === 'websocket') {
						if (typeof arrCurrent[3] === 'string') {
							arrCurrent[3] = arrCurrent[3].replace(/\r\n/gi, '\n');
						}
						var strArgs = arrCurrent[3];
						var arrStrExpectedOutput = arrCurrent[4];
						var arrStrActualOutput = [];
						change_status(intCurrent, 'waiting', 'running');
						var i = 0;
						var bolIsRead = strArgs.substring ? strArgs.substring(0, 9) === 'FILE\tREAD' : false;
						var bolIsWrite = strArgs.substring ? strArgs.substring(0, 10) === 'FILE\tWRITE' : false;
						//console.log('strArgs: ' + strArgs);
						GS.requestFromSocket(GS.envSocket, strArgs, function (data, error, errorData) {
							if (bolIsRead || bolIsWrite) {
								var lastModified = data.substring(0, data.indexOf('\n'));
								if (!lastModified) {
									lastModified = data;
								}
								console.log('lastModified: ' + lastModified);
								console.log(Local.tests[intCurrent + 1][3]);
								Local.tests[intCurrent + 1][3] = Local.tests[intCurrent + 1][3]
									.replace(/\{\{CHANGESTAMP\}\}/gi, GS.encodeForTabDelimited(lastModified)); // {{CHANGESTAMP}}
								bolIsRead = false;
								bolIsWrite = false;
							}
							if (i === -1) {
								return;
							}
							arrStrActualOutput.push(data.replace(/transactionid = .*\n/gim, ''));
							i += 1;
							if (i === arrStrExpectedOutput.length ||
								data === 'TRANSACTION COMPLETED' ||
								data.indexOf('FATAL') === 0
							) {
								console.log(i, data);
								var j, k, l, len, len1;
								for (j = 0, k = 0, len = i; j < len; j += 1, k += 1) {
									if (arrCurrent[0] === 'RAW W/NOTIFY') {
										console.log(arrStrActualOutput[j]);
										console.log(arrStrExpectedOutput[k]);
									}
									if (typeof (arrStrExpectedOutput[k]) === 'string') {
										//console.log(j, arrStrActualOutput[j]);
										//console.log(k, arrStrExpectedOutput[k]);
										if (arrStrActualOutput[j] === arrStrExpectedOutput[k] ||
											arrStrExpectedOutput[k] === 'ANYTHING' ||
											arrStrExpectedOutput[k].substring(0, 8) === 'OPTIONAL' ||
											(
												(
													arrStrExpectedOutput[k] === 'START' ||
													arrStrExpectedOutput[k] === 'END' ||
													arrStrExpectedOutput[k] === 'Failed to get canonical path' ||
													arrStrExpectedOutput[k] === 'Failed to open file for writing'
												) &&
												arrStrActualOutput[j].indexOf(arrStrExpectedOutput[k]) === 0
											)
										) {
											if (arrStrExpectedOutput[k].substring(0, 8) === 'OPTIONAL' &&
												arrStrActualOutput[j] !== arrStrExpectedOutput[k].substring(8)
											) {
												j -= 1;
											}
											error = false;
										} else {
											change_status(intCurrent, 'running', 'fail');
											error = true;
											break;
										}
									} else {
										error = true;
										var arrPossibleOutputs = arrStrExpectedOutput[k];
										for (l = 0, len1 = arrPossibleOutputs.length; l < len1; l += 1) {
											if (arrPossibleOutputs[l] == arrStrActualOutput[j]) {
												error = false;
												break;
											} else {
												error = true;
											}
										}
										if (error) {
											change_status(intCurrent, 'running', 'fail');
											break;
										}
									}
								}
								if (arrCurrent[0] === 'RAW W/NOTIFY') {
									console.log(j - 1, k - 1, len, error);
									console.log(arrStrActualOutput[j - 1]);
									console.log(arrStrExpectedOutput[k - 1]);
									console.log(btoa(unescape(encodeURIComponent(arrStrActualOutput[j - 1]))));
									console.log(btoa(unescape(encodeURIComponent(arrStrExpectedOutput[k - 1]))));
								}
								if (error === false) {
									change_status(intCurrent, 'running', 'pass', 0, JSON.stringify(arrStrActualOutput));
									run_test(intCurrent + 1);
									i = -1;
								} else {
									change_status(intCurrent, 'running', 'fail', 0, JSON.stringify(arrStrActualOutput));
									document.getElementById('actual_output').value = JSON.stringify(arrStrActualOutput);
									run_test(intCurrent + 1);
									i = -1;
								}
							}
						});
					} else if (strType === 'websocket cancel') {
						arrCurrent[3] = arrCurrent[3].replace(/\r\n/gi, '\n');
						strArgs = arrCurrent[3];
						arrStrExpectedOutput = arrCurrent[4];
						arrStrActualOutput = [];
						change_status(intCurrent, 'waiting', 'running');
						i = 0;
						GS.requestFromSocket(GS.envSocket, strArgs, function (data, error) {
							if (i === 0 && data.indexOf('QUERY') === 0) {
							} else if (i === 1 && data.indexOf('START') === 0) {
								GS.requestFromSocket(GS.envSocket, 'CANCEL', function (data) {
									console.log(data);
								});
							} else if (i === 2 && data.indexOf('END') === 0) {
							} else if (i === 3 && data === 'Query failed: ERROR:  canceling statement due to user request\n') {
								change_status(intCurrent, 'running', 'pass');
								run_test(intCurrent + 1);
							} else {
								document.getElementById('actual_status').value = i;
								document.getElementById('actual_output').value = data;
								change_status(intCurrent, 'running', 'fail');
							}
							i += 1;
						});
					} else if (strType === 'websocket end') {
						change_status(intCurrent, 'waiting', 'running');
						var i = 0;
						GS.requestFromSocket(GS.envSocket, 'SELECT	rtesting_large_table\nRETURN	*\n\n', function (data, error, errorData) {
							if (i === 0) {
								i += 1;

								GS.closeSocket(GS.envSocket);

								GS.envSocket = GS.openSocket('/env/1/env');
								var j = 0;
								GS.requestFromSocket(GS.envSocket, 'INFO\n', function (data, error, errorData) {
									if (j === 0) {
										j += 1;
										GS.closeSocket(GS.envSocket);
										var k = 0;
										GS.envSocket = GS.openSocket('/env/1/env');
										GS.requestFromSocket(GS.envSocket, 'SELECT	ttesting_large_view\nRETURN	*\n\n', function (data, error, errorData) {
											if (k === 0) {
												k += 1;
												GS.closeSocket(GS.envSocket);

												setTimeout(function () {
													GS.envSocket = GS.openSocket('/env/1/env');
													var l = 0;
													GS.requestFromSocket(GS.envSocket, 'SELECT	rtesting_table\nRETURN	*\n\n', function (data, error, errorData) {
														l += 1;
														if (l === 2) {
															GS.closeSocket(GS.envSocket);
															var ajax = GS.ajaxText('/env/action_select', 'src=generate_series(1,163000,1)&order_by=generate_series', function () {
															});

															setTimeout(function () {
																ajax.abort();
																ajax = GS.ajaxText('/env/action_select', 'src=generate_series(1,16300,1)&order_by=generate_series', function (data, error) {
																	if (!error) {
																		change_status(intCurrent, 'running', 'pass');
																		run_test(intCurrent + 1);
																	} else {
																		change_status(intCurrent, 'running', 'fail', ajax.status, data.error_text);
																		document.getElementById('actual_status').value = ajax.status;
																		document.getElementById('actual_output').value = data.error_text;
																		run_test(intCurrent + 1);
																	}
																});
															}, 1000);
														}
													});
												}, 15000);
											}
										});
									}
								});
							}
						});
						/*change_status(intCurrent, 'waiting', 'running');
						GS.closeSocket(GS.envSocket);
						change_status(intCurrent, 'running', 'pass');
						run_test(intCurrent + 1);*/
					} else if (strType === 'wait') {
						change_status(intCurrent, 'waiting', 'running');
						setTimeout(function () {
							change_status(intCurrent, 'running', 'pass');
							run_test(intCurrent + 1);
						}, 31000);
					}
				}
		</script>

		<style>
				.waiting {
						background-color: #0000FF;
						color: #FFFFFF;
				}

				.running {
						background-color: #FFFF00;
				}

				.fail {
						background-color: #FF0000;
						color: #FFFFFF;
				}

				.pass {
						background-color: #00FF00;
				}
		</style>
</head>
<body>
		<gs-page>
				<gs-body padded>
					<center>
		                <h3>
		                    Envelope Test Backend<br />
		                    <small><b id="iterations">0</b> Successful Iterations<b id="status-note"></b></small><br />
		                    <small>The reason we go one test at a time (even though it's slower) is so that if there is a crash we know which call caused it.</small>
		                </h3>
		                <gs-button onclick="bol_run = false; this.parentNode.removeChild(this);" inline>
		                    <b>Stop after this iteration</b>
		                </gs-button>
		                <gs-button onclick="if (bol_run) { bol_run = false; bol_refresh = true; this.parentNode.removeChild(this);} else { window.location = '/test.html'; }" inline>
		                    <b>Refresh Page after this iteration</b>
		                </gs-button>
		                <gs-button onclick="window.location = '/test.html'" inline>
		                    <b>Refresh Now</b>
		                </gs-button>
		                <gs-button onclick="window.open('/postage/0/action_ev?action=list');" inline>
		                    <b>List Watchers</b>
		                </gs-button>
		                <br />
		                <i><small>* -> means spam test, 100 iterations to pass</small></i>
		            </center>

								<gs-grid min-width="all {reflow}; sml {1,1,1}; med {1,1,1,1,1}; lrg {1,1,1,1,1,1,1,1};" gutter id="gridtests">
								</gs-grid>
						<label for="actual_status">Actual Status</label>
						<gs-text id="actual_status"></gs-text>
						<label for="actual_output">Actual Output</label>
						<gs-memo id="actual_output" autoresize rows="10"></gs-memo>
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
			            <br />
				</gs-body>
		</gs-page>
		<template id="errorDialog">
			<gs-header><h3 id="errorDialogHeader"></h3></gs-header>
			<gs-body><gs-memo id="errorDialogContent"></gs-memo></gs-body>
			<gs-footer>
				<gs-button dialogclose>Ok</gs-button>
			</gs-footer>
		</template>
</body>
</html>
